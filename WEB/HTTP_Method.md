# HTTP 메서드 멱등성과 GET/POST의 이해

## 멱등성(Idempotent)이란?

> 동일한 요청을 한 번 보내는 것과 여러 번 연속으로 보내는 것이 같은 효과를 지니고, 서버의 상태도 동일하게 남는 특성.
  
<br/>


### 멱등성이 보장되는 메서드

###### 1. GET

조회만 수행하므로 몇 번을 호출하더라도 동일한 결과
서버의 상태가 변경되지 않음

###### 2. PUT

전체 자원을 덮어쓰는 방식이므로 동일 요청은 항상 같은 결과

```java
// 첫 번째 요청
PUT /users/1
{
    "name": "John",
    "age": 30
}

// 두 번째 동일 요청도 같은 결과
// 서버 상태는 첫 번째 요청과 동일
```

###### 3. DELETE

자원을 삭제하는 요청이므로 여러 번 호출해도 결과는 동일

첫 번째 이후의 호출은 404 반환할 수 있지만, 서버 상태는 동일

<br>

### 멱등성이 보장되지 않는 메서드

###### 1. POST

매 요청마다 새로운 리소스 생성 가능
동일 요청이라도 서버 상태가 변경됨

```
// 첫 번째 요청
POST /orders
{
    "productId": "123",
    "quantity": 1
}
// 결과: orderId: 1 생성

// 동일한 두 번째 요청
// 결과: orderId: 2 생성 (새로운 주문)
```

###### 2. PATCH

리소스의 부분 수정에 사용
요청에 따라 다른 결과가 발생할 수 있음


```
// 카운터 증가 요청의 경우
PATCH /counter
{
    "action": "increment"
}
// 매 호출마다 카운터 값이 변경됨
```

---

#### GET

- URL에 데이터가 노출됨
- 브라우저 히스토리에 남음
- 뒤로 가기 안전
- <b>브라우저가 자동으로 캐싱</b>

#### POST

- Request Body에 데이터 전송
- 브라우저 히스토리에 남지 않음
- 뒤로 가기 시 재전송 여부 확인
- <b>자동 캐싱되지 않음</b>

<br>

---

### PUT을 사용해야 하는 경우
- 리소스의 완전한 교체가 필요할 때
- 모든 필드가 항상 포함되어야 할 때
- 멱등성이 반드시 보장되어야 할 때
### PATCH를 사용해야 하는 경우
- 부분 업데이트가 필요할 때
- 특정 필드만 수정하고 싶을 때
- 상태 변경과 같은 부분 수정이 필요할 때